var mysql=require('mysql');

function connectServer(){

    var client=mysql.createConnection({
        host:'192.168.0.254',
        user:'tataufo',
        password:'Inno3pku',
        database:'test_gc1'
    })

    return client;
}


function  selectFun(client,username,callback){
    //client为一个mysql连接对象
    client.query('select password from tb_user where username="'+username+'"',function(err,results,fields){
        if(err) throw err;

        callback(results);
    });
}

function insertFun(client , username , password,callback){
    console.log( username + password);
    client.query('insert into table_1 (username,password)values (?,?)', [username, password], function(err,result){
        if( err ){
            console.log( "error:" + err.message);
            return err;
        }
          callback(err);
    });
}

function  getDeviceList(client, county_id, callback){
    //client为一个mysql连接对象
    client.query('select device_id,device_pos,device_name,V_level from tb_device where county_id='+county_id ,function(err,results,fields){
        if(err) throw err;
        callback(results);
    });
}

function  getModuleList(client, device_id, callback){
    //client为一个mysql连接对象
    client.query('select module_id,module_name,module_type,module_pos,producer,running_date,verify_date,version,verify_code,net_address,bianbi,dingzhidanhao,device_id from tb_module where device_id='+device_id ,function(err,results,fields){
        if(err) throw err;
       
        callback(results);
    });
}

function  getVillageList(client, county_id, callback){
    //client为一个mysql连接对象
    client.query('select village_id, village_name,V_level from tb_village where county_id='+county_id ,function(err,results,fields){
        if(err) throw err;

        callback(results);
    });
}

exports.connect = connectServer;
exports.selectFun  = selectFun;
exports.insertFun = insertFun;
exports.getDeviceList = getDeviceList;
exports.getModuleList = getModuleList;
exports.getVillageList = getVillageList;
